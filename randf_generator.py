from yattag import Doc, indent
from xhtml2pdf import pisa
from datetime import datetime

def generateHtmlHeader(title: str) -> str:
    doc, tag, text, line = Doc().ttl()

    doc.asis('<!DOCTYPE html>')
    with tag('html'):
        with tag('head'):
            doc.stag('meta', charset='utf-8')
            with tag('title'):
                text(title)
            doc.stag('meta', name='description', content='An HTML file generated by the RANDF compiler.')
            doc.stag('meta', name='author', content='RANDF Compiler')
        with tag('body'):
            with tag('h1'):
                text('Hello world!')
            with tag('p'):
                text(datetime.now().strftime("%d/%m/%Y %H:%M:%S"))

    return (indent(doc.getvalue()))


def convertHtmlToPdf(raw_html: str, raw_css: str) -> bool:
    mycss = """
    body {
        font-family: "Times New Roman", Times, serif;
        display: block;
        margin: 8px;
    }
    h1 {
        display: block;
        font-size: 2em;
        margin-top: 0.67em;
        margin-bottom: 0.67em;
        margin-left: 0;
        margin-right: 0;
        font-weight: bold;
    }
    """

    result_file = open("out.pdf", "w+b")
    status = pisa.CreatePDF(raw_html, dest=result_file, default_css=mycss)
    result_file.close()
    return status

